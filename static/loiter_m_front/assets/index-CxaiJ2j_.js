import{d as ge,u as ye,e as Ie,a as Ve,f as ke,t as we,E as q}from"./el-button-BiYwfNb7.js";import{F as Ee,G as x,X as $e,al as H,P as J,ak as Z,d as G,m as Ne,D as z,r as C,aw as Se,L as j,o as K,a as n,c as E,b as o,e as i,a6 as T,aD as Ce,n as $,w as b,ab as Y,Q as O,ai as P,t as ee,f as u,aE as Le,q as ue,aq as Pe,ap as Te,y as De,a3 as Ae,aF as pe,a7 as Be,K as B,U as M,aa as F,h as U,i as D,j as A,E as N,at as Q,au as R,ax as me,ay as ve,aB as ze,aG as Ue}from"./index-NHIm5-uZ.js";import{E as Ge}from"./el-date-picker-D5HFMzYi.js";import{U as ae,C as te,I as le,E as fe}from"./el-input-D9jqeYXg.js";import{E as se,a as ne}from"./el-select-DZX1Ptzy.js";import"./el-popper-XxQwgVmP.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as Oe}from"./el-pagination-_FHyq6Tc.js";import{a as Me,E as Fe}from"./el-table-column-M44UI9A7.js";import"./el-tooltip-l0sNRNKZ.js";import{E as Ke}from"./el-popover-CUqzKF0H.js";import{E as _e}from"./el-overlay-CHWBwd7q.js";import{a as Ye,c as je}from"./utils-C-h4WIq6.js";import{i as qe}from"./validator-CEv5_dqZ.js";import{h as de}from"./moment-Cl4UOzQZ.js";import"./index-C1H9JqF_.js";import"./vnode-Ch83emUg.js";const We=Ee({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:qe},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:x},activeActionIcon:{type:x},activeIcon:{type:x},inactiveIcon:{type:x},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:$e(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0}}),xe={[ae]:l=>H(l)||J(l)||Z(l),[te]:l=>H(l)||J(l)||Z(l),[le]:l=>H(l)||J(l)||Z(l)},He=["onClick"],Qe=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],Re=["aria-hidden"],Xe=["aria-hidden"],Je=["aria-hidden"],he="ElSwitch",Ze=G({name:he}),ea=G({...Ze,props:We,emits:xe,setup(l,{expose:S,emit:w}){const c=l,{formItem:I}=ge(),r=ye(),t=Ne("switch"),{inputId:m}=Ie(c,{formItemContext:I}),_=Ve(z(()=>c.loading)),g=C(c.modelValue!==!1),d=C(),v=C(),a=z(()=>[t.b(),t.m(r.value),t.is("disabled",_.value),t.is("checked",y.value)]),s=z(()=>[t.e("label"),t.em("label","left"),t.is("active",!y.value)]),p=z(()=>[t.e("label"),t.em("label","right"),t.is("active",y.value)]),k=z(()=>({width:Se(c.width)}));j(()=>c.modelValue,()=>{g.value=!0});const f=z(()=>g.value?c.modelValue:!1),y=z(()=>f.value===c.activeValue);[c.activeValue,c.inactiveValue].includes(f.value)||(w(ae,c.inactiveValue),w(te,c.inactiveValue),w(le,c.inactiveValue)),j(y,e=>{var L;d.value.checked=e,c.validateEvent&&((L=I==null?void 0:I.validate)==null||L.call(I,"change").catch(be=>ke()))});const V=()=>{const e=y.value?c.inactiveValue:c.activeValue;w(ae,e),w(te,e),w(le,e),Ae(()=>{d.value.checked=y.value})},h=()=>{if(_.value)return;const{beforeChange:e}=c;if(!e){V();return}const L=e();[pe(L),H(L)].includes(!0)||we(he,"beforeChange must return type `Promise<boolean>` or `boolean`"),pe(L)?L.then(ce=>{ce&&V()}).catch(ce=>{}):L&&V()},re=()=>{var e,L;(L=(e=d.value)==null?void 0:e.focus)==null||L.call(e)};return K(()=>{d.value.checked=y.value}),S({focus:re,checked:y}),(e,L)=>(n(),E("div",{class:T(i(a)),onClick:Te(h,["prevent"])},[o("input",{id:i(m),ref_key:"input",ref:d,class:T(i(t).e("input")),type:"checkbox",role:"switch","aria-checked":i(y),"aria-disabled":i(_),"aria-label":e.label,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:i(_),tabindex:e.tabindex,onChange:V,onKeydown:Ce(h,["enter"])},null,42,Qe),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(n(),E("span",{key:0,class:T(i(s))},[e.inactiveIcon?(n(),$(i(O),{key:0},{default:b(()=>[(n(),$(Y(e.inactiveIcon)))]),_:1})):P("v-if",!0),!e.inactiveIcon&&e.inactiveText?(n(),E("span",{key:1,"aria-hidden":i(y)},ee(e.inactiveText),9,Re)):P("v-if",!0)],2)):P("v-if",!0),o("span",{ref_key:"core",ref:v,class:T(i(t).e("core")),style:Pe(i(k))},[e.inlinePrompt?(n(),E("div",{key:0,class:T(i(t).e("inner"))},[e.activeIcon||e.inactiveIcon?(n(),$(i(O),{key:0,class:T(i(t).is("icon"))},{default:b(()=>[(n(),$(Y(i(y)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(n(),E("span",{key:1,class:T(i(t).is("text")),"aria-hidden":!i(y)},ee(i(y)?e.activeText:e.inactiveText),11,Xe)):P("v-if",!0)],2)):P("v-if",!0),o("div",{class:T(i(t).e("action"))},[e.loading?(n(),$(i(O),{key:0,class:T(i(t).is("loading"))},{default:b(()=>[u(i(Le))]),_:1},8,["class"])):i(y)?ue(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(n(),$(i(O),{key:0},{default:b(()=>[(n(),$(Y(e.activeActionIcon)))]),_:1})):P("v-if",!0)]):i(y)?P("v-if",!0):ue(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(n(),$(i(O),{key:0},{default:b(()=>[(n(),$(Y(e.inactiveActionIcon)))]),_:1})):P("v-if",!0)])],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(n(),E("span",{key:1,class:T(i(p))},[e.activeIcon?(n(),$(i(O),{key:0},{default:b(()=>[(n(),$(Y(e.activeIcon)))]),_:1})):P("v-if",!0),!e.activeIcon&&e.activeText?(n(),E("span",{key:1,"aria-hidden":!i(y)},ee(e.activeText),9,Je)):P("v-if",!0)],2)):P("v-if",!0)],10,He))}});var aa=De(ea,[["__file","switch.vue"]]);const ta=Be(aa),X=l=>(Q("data-v-55ba39fc"),l=l(),R(),l),la={class:"condition"},sa={class:"line"},na={class:"inputGroup"},oa=X(()=>o("span",{class:"label"},"应用:",-1)),ia={class:"inputGroup"},ra=X(()=>o("span",{class:"label"},"ip:",-1)),ca={class:"inputGroup"},ua=X(()=>o("span",{class:"label"},"备注:",-1)),pa={class:"line"},da=X(()=>o("span",{class:"label"},"时间:",-1)),ma={class:"buttonGroup"},va=G({__name:"condition",emits:["search"],setup(l,{emit:S}){const w=S,c=B([]),I=C([]),r=B({appId:"",ip:"",remarks:""});function t(){D.getAppDictionary().then(({code:g,msg:d,data:v})=>{if(g!=A.success){N({type:"error",message:"应用信息获取失败："+d});return}v.forEach((a,s)=>{c[s]={label:a.label,value:a.value}})})}function m(){r.appId="",r.ip="",r.remarks="",I.value=[]}function _(){w("search",r,I.value)}return K(()=>{t()}),(g,d)=>{const v=se,a=ne,s=fe,p=Ge,k=q;return n(),E("div",la,[o("div",sa,[o("div",na,[oa,u(a,{class:"input",modelValue:r.appId,"onUpdate:modelValue":d[0]||(d[0]=f=>r.appId=f),filterable:"",clearable:"",placeholder:""},{default:b(()=>[(n(!0),E(M,null,F(c,f=>(n(),$(v,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",ia,[ra,u(s,{class:"input",modelValue:r.ip,"onUpdate:modelValue":d[1]||(d[1]=f=>r.ip=f),clearable:""},null,8,["modelValue"])]),o("div",ca,[ua,u(s,{class:"input",modelValue:r.remarks,"onUpdate:modelValue":d[2]||(d[2]=f=>r.remarks=f),clearable:""},null,8,["modelValue"])])]),o("div",pa,[o("div",null,[da,u(p,{class:"timeRange",modelValue:I.value,"onUpdate:modelValue":d[3]||(d[3]=f=>I.value=f),type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束"},null,8,["modelValue"])])]),o("div",ma,[u(k,{class:"search",type:"primary",onClick:_},{default:b(()=>[U("查询")]),_:1}),u(k,{class:"reset",onClick:m},{default:b(()=>[U("重置")]),_:1})])])}}}),fa=W(va,[["__scopeId","data-v-55ba39fc"]]),_a={class:"ipTable"},ha="total, sizes, prev, pager, next",ba=G({__name:"ipTable",props:{genre:Object,condition:Object,refresh:Number},setup(l){const S=l,w=C([]),c=C([{prop:"appName",label:"应用名"},{prop:"ip",label:"IP地址"},{prop:"remarks",label:"备注"},{prop:"createdAt",label:"创建时间"}]),I=C(1),r=C(10),t=C(0),m=[10,50,100,200];j(()=>S.refresh,a=>{I.value=1,_()});function _(){D.getNameList({...S.condition,genre:S.genre.value,pageNo:I.value,pageSize:r.value}).then(({code:a,msg:s,data:p})=>{if(a!=A.success){N({type:"error",message:"IP 名单获取失败："+s});return}w.value=p.data,t.value=p.total})}function g(a){r.value=a,_()}function d(a){I.value=a,_()}function v(a){D.deleteNameListIp({appId:a.row.appId,id:a.row.id,ip:a.row.ip,genre:S.genre.value}).then(({code:s,msg:p})=>{if(s!=A.success){N({type:"error",message:"IP 删除失败："+p});return}_()})}return K(()=>{_()}),(a,s)=>{const p=Me,k=q,f=Ke,y=Fe,V=Oe;return n(),E("div",_a,[u(y,{class:"table",border:!0,data:w.value},{default:b(()=>[u(p,{type:"index",align:"center",label:S.genre.label.charAt(0)},null,8,["label"]),(n(!0),E(M,null,F(c.value,h=>(n(),$(p,{prop:h.prop,label:h.label,align:"center"},null,8,["prop","label"]))),256)),u(p,{prop:"content",label:"操作",align:"center"},{default:b(h=>[u(f,{title:"确认删除吗?",onConfirm:re=>v(h)},{reference:b(()=>[u(k,{size:"small"},{default:b(()=>[U("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),u(V,{class:"pagination",layout:ha,"page-sizes":m,"current-page":I.value,"page-size":r.value,total:t.value,onCurrentChange:d,onSizeChange:g},null,8,["current-page","page-size","total"])])}}}),ga=W(ba,[["__scopeId","data-v-2d4e68eb"]]),oe=l=>(Q("data-v-2ef12206"),l=l(),R(),l),ya={class:"add"},Ia={class:"inputGroup"},Va=oe(()=>o("span",{class:"label"},"应用名",-1)),ka={class:"inputGroup"},wa=oe(()=>o("span",{class:"label"},"名单类型",-1)),Ea={class:"inputGroup"},$a=oe(()=>o("span",{class:"label"},"IP 地址",-1)),Na={class:"dialog-footer"},Sa=G({__name:"add",props:{show:Number},emits:["reload"],setup(l,{emit:S}){const w=me(),c=B([]),I=B([]),r=l,t=C(!1),m=B({appId:"",genre:"",ipList:""});j(()=>r.show,a=>{d(),t.value=!0});function _(){D.getAppDictionary().then(({code:a,msg:s,data:p})=>{if(a!=A.success){N({type:"error",message:"应用信息获取失败："+s});return}p.forEach((k,f)=>{c[f]={label:k.label,value:k.value}})})}function g(){D.getNameListDictionary().then(({code:a,msg:s,data:p})=>{if(a!=A.success){N({type:"error",message:"黑白名单字典获取失败："+s});return}p.forEach((k,f)=>{I[f]={label:k.label,value:k.value}})})}function d(){m.appId="",m.genre="",m.ipList=""}function v(){if(!w.checkAuth(ve.admin)){N({type:"error",message:"权限不足！"});return}if(m.ipList==null){N({type:"error",message:"IP地址必填！"});return}let a=Ye(m.ipList);for(let s in a)if(!je(a[s])){N({type:"error",message:"IP格式不对："+a[s]});return}D.addNameListIp({appId:m.appId?Number(m.appId):null,genre:m.genre,ipList:m.ipList.split(/\r?\n/)}).then(({code:s,msg:p})=>{if(s!=A.success){N({type:"error",message:"添加IP失败："+p});return}N({type:"success",message:"IP添加成功"}),t.value=!1})}return K(()=>{_(),g()}),(a,s)=>{const p=se,k=ne,f=fe,y=q,V=_e;return n(),E("div",ya,[u(V,{class:"add",modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=h=>t.value=h),title:"增加名单ip",width:"480"},{footer:b(()=>[o("div",Na,[u(y,{onClick:s[3]||(s[3]=h=>t.value=!1)},{default:b(()=>[U("取消")]),_:1}),u(y,{type:"primary",onClick:v},{default:b(()=>[U("保存")]),_:1})])]),default:b(()=>[o("div",null,[o("div",Ia,[Va,u(k,{class:"input",modelValue:m.appId,"onUpdate:modelValue":s[0]||(s[0]=h=>m.appId=h),clearable:""},{default:b(()=>[(n(!0),E(M,null,F(c,h=>(n(),$(p,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",ka,[wa,u(k,{class:"input",modelValue:m.genre,"onUpdate:modelValue":s[1]||(s[1]=h=>m.genre=h),clearable:""},{default:b(()=>[(n(!0),E(M,null,F(I,h=>(n(),$(p,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",Ea,[$a,u(f,{class:"input",type:"textarea",modelValue:m.ipList,"onUpdate:modelValue":s[2]||(s[2]=h=>m.ipList=h),rows:6,clearable:"",placeholder:"不同ip请换行区分"},null,8,["modelValue"])])])]),_:1},8,["modelValue"])])}}}),Ca=W(Sa,[["__scopeId","data-v-2ef12206"]]),ie=l=>(Q("data-v-aa7e8877"),l=l(),R(),l),La={class:"switch"},Pa={class:"inputGroup"},Ta=ie(()=>o("span",{class:"label"},"应用名",-1)),Da={class:"switchGroup"},Aa={class:"switchItem"},Ba=ie(()=>o("span",null,"黑名单：",-1)),za={class:"switchItem"},Ua=ie(()=>o("span",null,"白名单：",-1)),Ga={class:"dialog-footer"},Oa=G({__name:"switch",props:{show:Number},emits:["reload"],setup(l,{emit:S}){const w=me(),c=B([]),I=l,r=C(!1),t=B({appId:"",black:!1,white:!1});j(()=>I.show,v=>{d(),r.value=!0});function m(){D.getAppDictionary().then(({code:v,msg:a,data:s})=>{if(v!=A.success){N({type:"error",message:"应用信息获取失败："+a});return}s.forEach((p,k)=>{c[k]={label:p.label,value:p.value}})})}function _(v){v||d(),D.getAppNameListStatus([v]).then(({code:a,msg:s,data:p})=>{if(a!=A.success){N({type:"error",message:"应用黑白名单状态获取失败："+s});return}t.black=p.black,t.white=p.white})}function g(){if(!w.checkAuth(ve.admin)){N({type:"error",message:"权限不足！"});return}if(!t.appId){N({type:"error",message:"请选择目标应用！"});return}D.updateAppNameList({...t,appId:t.appId?Number(t.appId):null}).then(({code:v,msg:a})=>{if(v!=A.success){N({type:"error",message:"应用黑白名单状态更新失败："+a});return}N({type:"success",message:"应用黑白名单状态更新成功！"}),r.value=!1})}function d(){t.appId="",t.black=!1,t.white=!1}return K(()=>{m()}),(v,a)=>{const s=se,p=ne,k=ta,f=q,y=_e;return n(),E("div",La,[u(y,{class:"save",modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=V=>r.value=V),title:"切换名单状态",width:"430"},{footer:b(()=>[o("div",Ga,[u(f,{onClick:a[3]||(a[3]=V=>r.value=!1)},{default:b(()=>[U("取消")]),_:1}),u(f,{type:"primary",onClick:g},{default:b(()=>[U("保存")]),_:1})])]),default:b(()=>[o("div",null,[o("div",Pa,[Ta,u(p,{class:"input",modelValue:t.appId,"onUpdate:modelValue":a[0]||(a[0]=V=>t.appId=V),clearable:"",onChange:_},{default:b(()=>[(n(!0),E(M,null,F(c,V=>(n(),$(s,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",Da,[o("div",Aa,[Ba,u(k,{modelValue:t.black,"onUpdate:modelValue":a[1]||(a[1]=V=>t.black=V)},null,8,["modelValue"])]),o("div",za,[Ua,u(k,{modelValue:t.white,"onUpdate:modelValue":a[2]||(a[2]=V=>t.white=V)},null,8,["modelValue"])])])])]),_:1},8,["modelValue"])])}}}),Ma=W(Oa,[["__scopeId","data-v-aa7e8877"]]),Fa=l=>(Q("data-v-3b7456f2"),l=l(),R(),l),Ka={class:"nameList"},Ya={class:"ipTableGroup"},ja={class:"btnGroup"},qa=Fa(()=>o("div",{class:"segment"},null,-1)),Wa=G({__name:"index",setup(l){const S=C(0),w=C(0),c=B([]),I=C(0);let r={appId:0,ip:"",remarks:"",timeBegin:"",timeEnd:""};function t(_,g){r.appId=_.appId?Number(_.appId):0,r.ip=_.ip,r.remarks=_.remarks,r.timeBegin=g[0]?de(g[0]).format("YYYY-MM-DD"):"",r.timeEnd=g[1]?de(g[1]).format("YYYY-MM-DD"):"",I.value++}function m(){D.getNameListDictionary().then(({code:_,msg:g,data:d})=>{if(_!=A.success){N({type:"error",message:"黑白名单字典获取失败："+g});return}d.forEach((v,a)=>{c[a]={label:v.label,value:v.value}})})}return K(()=>{m()}),(_,g)=>{const d=q;return n(),E("div",Ka,[u(fa,{onSearch:t}),o("div",Ya,[(n(!0),E(M,null,F(c,v=>(n(),$(ga,{class:"table",genre:v,condition:i(r),refresh:I.value},null,8,["genre","condition","refresh"]))),256))]),u(Ca,{show:S.value},null,8,["show"]),u(Ma,{show:w.value},null,8,["show"]),o("div",ja,[u(d,{class:"btn",icon:i(ze),type:"primary",circle:"",size:"large",onClick:g[0]||(g[0]=v=>S.value++)},null,8,["icon"]),qa,u(d,{class:"btn",icon:i(Ue),type:"primary",circle:"",size:"large",onClick:g[1]||(g[1]=v=>w.value++)},null,8,["icon"])])])}}}),ut=W(Wa,[["__scopeId","data-v-3b7456f2"]]);export{ut as default};
