import{d as ge,u as Ie,e as Ve,a as ke,f as we,t as $e,E as j}from"./el-button-C0k8b0Uu.js";import{F as Ee,G as Y,X as Se,al as K,P as Z,ak as x,d as O,m as Ne,D,r as A,aw as Ce,L as q,o as Q,a as i,c as V,b as s,e as n,a6 as C,aE as Le,n as w,w as _,ab as z,Q as G,ai as S,t as ee,f as u,aF as Te,q as re,aq as Ae,ap as De,y as Pe,a3 as Be,aG as ue,a7 as Ue,K as P,U as H,aa as W,h as M,i as B,j as U,E as $,at as R,au as X,ax as me,ay as ve,aB as Ge,aH as Me}from"./index-PF-Fl51z.js";import{E as Oe}from"./el-date-picker-B0nW_AG2.js";import{U as ae,C as te,I as se,E as fe}from"./el-input-Bl7HZI7a.js";import{E as le,a as oe}from"./el-select-B6CuLMMT.js";import"./el-popper-BcKKSjAX.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as _e}from"./el-overlay-HUXVHpxd.js";import{a as ze,c as Fe}from"./utils-C-h4WIq6.js";import{i as Ye}from"./validator-C-D_yV1G.js";import{h as de}from"./moment-Cl4UOzQZ.js";import"./flatten-D1jLvMYC.js";import"./index-_QU7_dNm.js";import"./vnode-D19UwqZF.js";const Ke=Ee({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:Ye},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:Y},activeActionIcon:{type:Y},activeIcon:{type:Y},inactiveIcon:{type:Y},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Se(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0}}),qe={[ae]:t=>K(t)||Z(t)||x(t),[te]:t=>K(t)||Z(t)||x(t),[se]:t=>K(t)||Z(t)||x(t)},He=["onClick"],We=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],je=["aria-hidden"],Qe=["aria-hidden"],Re=["aria-hidden"],he="ElSwitch",Xe=O({name:he}),Je=O({...Xe,props:Ke,emits:qe,setup(t,{expose:L,emit:k}){const r=t,{formItem:h}=ge(),c=Ie(),a=Ne("switch"),{inputId:d}=Ve(r,{formItemContext:h}),N=ke(D(()=>r.loading)),T=A(r.modelValue!==!1),m=A(),I=A(),l=D(()=>[a.b(),a.m(c.value),a.is("disabled",N.value),a.is("checked",v.value)]),o=D(()=>[a.e("label"),a.em("label","left"),a.is("active",!v.value)]),f=D(()=>[a.e("label"),a.em("label","right"),a.is("active",v.value)]),g=D(()=>({width:Ce(r.width)}));q(()=>r.modelValue,()=>{T.value=!0});const p=D(()=>T.value?r.modelValue:!1),v=D(()=>p.value===r.activeValue);[r.activeValue,r.inactiveValue].includes(p.value)||(k(ae,r.inactiveValue),k(te,r.inactiveValue),k(se,r.inactiveValue)),q(v,e=>{var E;m.value.checked=e,r.validateEvent&&((E=h==null?void 0:h.validate)==null||E.call(h,"change").catch(ye=>we()))});const b=()=>{const e=v.value?r.inactiveValue:r.activeValue;k(ae,e),k(te,e),k(se,e),Be(()=>{m.value.checked=v.value})},y=()=>{if(N.value)return;const{beforeChange:e}=r;if(!e){b();return}const E=e();[ue(E),K(E)].includes(!0)||$e(he,"beforeChange must return type `Promise<boolean>` or `boolean`"),ue(E)?E.then(ce=>{ce&&b()}).catch(ce=>{}):E&&b()},be=()=>{var e,E;(E=(e=m.value)==null?void 0:e.focus)==null||E.call(e)};return Q(()=>{m.value.checked=v.value}),L({focus:be,checked:v}),(e,E)=>(i(),V("div",{class:C(n(l)),onClick:De(y,["prevent"])},[s("input",{id:n(d),ref_key:"input",ref:m,class:C(n(a).e("input")),type:"checkbox",role:"switch","aria-checked":n(v),"aria-disabled":n(N),"aria-label":e.label,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:n(N),tabindex:e.tabindex,onChange:b,onKeydown:Le(y,["enter"])},null,42,We),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(i(),V("span",{key:0,class:C(n(o))},[e.inactiveIcon?(i(),w(n(G),{key:0},{default:_(()=>[(i(),w(z(e.inactiveIcon)))]),_:1})):S("v-if",!0),!e.inactiveIcon&&e.inactiveText?(i(),V("span",{key:1,"aria-hidden":n(v)},ee(e.inactiveText),9,je)):S("v-if",!0)],2)):S("v-if",!0),s("span",{ref_key:"core",ref:I,class:C(n(a).e("core")),style:Ae(n(g))},[e.inlinePrompt?(i(),V("div",{key:0,class:C(n(a).e("inner"))},[e.activeIcon||e.inactiveIcon?(i(),w(n(G),{key:0,class:C(n(a).is("icon"))},{default:_(()=>[(i(),w(z(n(v)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(i(),V("span",{key:1,class:C(n(a).is("text")),"aria-hidden":!n(v)},ee(n(v)?e.activeText:e.inactiveText),11,Qe)):S("v-if",!0)],2)):S("v-if",!0),s("div",{class:C(n(a).e("action"))},[e.loading?(i(),w(n(G),{key:0,class:C(n(a).is("loading"))},{default:_(()=>[u(n(Te))]),_:1},8,["class"])):n(v)?re(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(i(),w(n(G),{key:0},{default:_(()=>[(i(),w(z(e.activeActionIcon)))]),_:1})):S("v-if",!0)]):n(v)?S("v-if",!0):re(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(i(),w(n(G),{key:0},{default:_(()=>[(i(),w(z(e.inactiveActionIcon)))]),_:1})):S("v-if",!0)])],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(i(),V("span",{key:1,class:C(n(f))},[e.activeIcon?(i(),w(n(G),{key:0},{default:_(()=>[(i(),w(z(e.activeIcon)))]),_:1})):S("v-if",!0),!e.activeIcon&&e.activeText?(i(),V("span",{key:1,"aria-hidden":!n(v)},ee(e.activeText),9,Re)):S("v-if",!0)],2)):S("v-if",!0)],10,He))}});var Ze=Pe(Je,[["__file","switch.vue"]]);const xe=Ue(Ze),J=t=>(R("data-v-55ba39fc"),t=t(),X(),t),ea={class:"condition"},aa={class:"line"},ta={class:"inputGroup"},sa=J(()=>s("span",{class:"label"},"应用:",-1)),la={class:"inputGroup"},oa=J(()=>s("span",{class:"label"},"ip:",-1)),na={class:"inputGroup"},ia=J(()=>s("span",{class:"label"},"备注:",-1)),ca={class:"line"},ra=J(()=>s("span",{class:"label"},"时间:",-1)),ua={class:"buttonGroup"},da=O({__name:"condition",emits:["search"],setup(t,{emit:L}){const k=L,r=P([]),h=A([]),c=P({appId:"",ip:"",remarks:""});function a(){B.getAppDictionary().then(({code:T,msg:m,data:I})=>{if(T!=U.success){$({type:"error",message:"应用信息获取失败："+m});return}I.forEach((l,o)=>{r[o]={label:l.label,value:l.value}})})}function d(){c.appId="",c.ip="",c.remarks="",h.value=[]}function N(){k("search",c,h.value)}return Q(()=>{a()}),(T,m)=>{const I=le,l=oe,o=fe,f=Oe,g=j;return i(),V("div",ea,[s("div",aa,[s("div",ta,[sa,u(l,{class:"input",modelValue:c.appId,"onUpdate:modelValue":m[0]||(m[0]=p=>c.appId=p),filterable:"",clearable:"",placeholder:""},{default:_(()=>[(i(!0),V(H,null,W(r,p=>(i(),w(I,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",la,[oa,u(o,{class:"input",modelValue:c.ip,"onUpdate:modelValue":m[1]||(m[1]=p=>c.ip=p),clearable:""},null,8,["modelValue"])]),s("div",na,[ia,u(o,{class:"input",modelValue:c.remarks,"onUpdate:modelValue":m[2]||(m[2]=p=>c.remarks=p),clearable:""},null,8,["modelValue"])])]),s("div",ca,[s("div",null,[ra,u(f,{class:"timeRange",modelValue:h.value,"onUpdate:modelValue":m[3]||(m[3]=p=>h.value=p),type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束"},null,8,["modelValue"])])]),s("div",ua,[u(g,{class:"search",type:"primary",onClick:N},{default:_(()=>[M("查询")]),_:1}),u(g,{class:"reset",onClick:d},{default:_(()=>[M("重置")]),_:1})])])}}}),pa=F(da,[["__scopeId","data-v-55ba39fc"]]),ma={},va={class:"nameList"};function fa(t,L){return i(),V("div",va)}const pe=F(ma,[["render",fa]]),ne=t=>(R("data-v-2ef12206"),t=t(),X(),t),_a={class:"add"},ha={class:"inputGroup"},ba=ne(()=>s("span",{class:"label"},"应用名",-1)),ya={class:"inputGroup"},ga=ne(()=>s("span",{class:"label"},"名单类型",-1)),Ia={class:"inputGroup"},Va=ne(()=>s("span",{class:"label"},"IP 地址",-1)),ka={class:"dialog-footer"},wa=O({__name:"add",props:{show:Number},emits:["reload"],setup(t,{emit:L}){const k=me(),r=P([]),h=P([]),c=t,a=A(!1),d=P({appId:"",genre:"",ipList:""});q(()=>c.show,l=>{m(),a.value=!0});function N(){B.getAppDictionary().then(({code:l,msg:o,data:f})=>{if(l!=U.success){$({type:"error",message:"应用信息获取失败："+o});return}f.forEach((g,p)=>{r[p]={label:g.label,value:g.value}})})}function T(){B.getNameListDictionary().then(({code:l,msg:o,data:f})=>{if(l!=U.success){$({type:"error",message:"黑白名单字典获取失败："+o});return}f.forEach((g,p)=>{h[p]={label:g.label,value:g.value}})})}function m(){d.appId="",d.genre="",d.ipList=""}function I(){if(!k.checkAuth(ve.admin)){$({type:"error",message:"权限不足！"});return}if(d.ipList==null){$({type:"error",message:"IP地址必填！"});return}let l=ze(d.ipList);for(let o in l)if(!Fe(l[o])){$({type:"error",message:"IP格式不对："+l[o]});return}B.addNameListIp({appId:d.appId?Number(d.appId):null,genre:d.genre,ipList:d.ipList.split(/\r?\n/)}).then(({code:o,msg:f})=>{if(o!=U.success){$({type:"error",message:"添加IP失败："+f});return}$({type:"success",message:"IP添加成功"}),a.value=!1})}return Q(()=>{N(),T()}),(l,o)=>{const f=le,g=oe,p=fe,v=j,b=_e;return i(),V("div",_a,[u(b,{class:"add",modelValue:a.value,"onUpdate:modelValue":o[4]||(o[4]=y=>a.value=y),title:"增加名单ip",width:"480"},{footer:_(()=>[s("div",ka,[u(v,{onClick:o[3]||(o[3]=y=>a.value=!1)},{default:_(()=>[M("取消")]),_:1}),u(v,{type:"primary",onClick:I},{default:_(()=>[M("保存")]),_:1})])]),default:_(()=>[s("div",null,[s("div",ha,[ba,u(g,{class:"input",modelValue:d.appId,"onUpdate:modelValue":o[0]||(o[0]=y=>d.appId=y),clearable:""},{default:_(()=>[(i(!0),V(H,null,W(r,y=>(i(),w(f,{key:y.value,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",ya,[ga,u(g,{class:"input",modelValue:d.genre,"onUpdate:modelValue":o[1]||(o[1]=y=>d.genre=y),clearable:""},{default:_(()=>[(i(!0),V(H,null,W(h,y=>(i(),w(f,{key:y.value,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",Ia,[Va,u(p,{class:"input",type:"textarea",modelValue:d.ipList,"onUpdate:modelValue":o[2]||(o[2]=y=>d.ipList=y),rows:6,clearable:"",placeholder:"不同ip请换行区分"},null,8,["modelValue"])])])]),_:1},8,["modelValue"])])}}}),$a=F(wa,[["__scopeId","data-v-2ef12206"]]),ie=t=>(R("data-v-4e88f7c0"),t=t(),X(),t),Ea={class:"switch"},Sa={class:"inputGroup"},Na=ie(()=>s("span",{class:"label"},"应用名",-1)),Ca={class:"switchGroup"},La={class:"switchItem"},Ta=ie(()=>s("span",null,"黑名单：",-1)),Aa={class:"switchItem"},Da=ie(()=>s("span",null,"白名单：",-1)),Pa={class:"dialog-footer"},Ba=O({__name:"switch",props:{show:Number},emits:["reload"],setup(t,{emit:L}){const k=me(),r=P([]),h=t,c=A(!1),a=P({appId:"",black:!1,white:!1});q(()=>h.show,I=>{m(),c.value=!0});function d(){B.getAppDictionary().then(({code:I,msg:l,data:o})=>{if(I!=U.success){$({type:"error",message:"应用信息获取失败："+l});return}o.forEach((f,g)=>{r[g]={label:f.label,value:f.value}})})}function N(I){I||m(),B.getAppNameList([I]).then(({code:l,msg:o,data:f})=>{if(l!=U.success){$({type:"error",message:"应用黑白名单状态获取失败："+o});return}a.black=f.black,a.white=f.white})}function T(){if(!k.checkAuth(ve.admin)){$({type:"error",message:"权限不足！"});return}if(!a.appId){$({type:"error",message:"请选择目标应用！"});return}B.updateAppNameList({...a,appId:a.appId?Number(a.appId):null}).then(({code:I,msg:l})=>{if(I!=U.success){$({type:"error",message:"应用黑白名单状态更新失败："+l});return}$({type:"success",message:"应用黑白名单状态更新成功！"}),c.value=!1})}function m(){a.appId="",a.black=!1,a.white=!1}return Q(()=>{d()}),(I,l)=>{const o=le,f=oe,g=xe,p=j,v=_e;return i(),V("div",Ea,[u(v,{class:"save",modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=b=>c.value=b),title:"切换名单状态",width:"430"},{footer:_(()=>[s("div",Pa,[u(p,{onClick:l[3]||(l[3]=b=>c.value=!1)},{default:_(()=>[M("取消")]),_:1}),u(p,{type:"primary",onClick:T},{default:_(()=>[M("保存")]),_:1})])]),default:_(()=>[s("div",null,[s("div",Sa,[Na,u(f,{class:"input",modelValue:a.appId,"onUpdate:modelValue":l[0]||(l[0]=b=>a.appId=b),clearable:"",onChange:N},{default:_(()=>[(i(!0),V(H,null,W(r,b=>(i(),w(o,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",Ca,[s("div",La,[Ta,u(g,{modelValue:a.black,"onUpdate:modelValue":l[1]||(l[1]=b=>a.black=b)},null,8,["modelValue"])]),s("div",Aa,[Da,u(g,{modelValue:a.white,"onUpdate:modelValue":l[2]||(l[2]=b=>a.white=b)},null,8,["modelValue"])])])])]),_:1},8,["modelValue"])])}}}),Ua=F(Ba,[["__scopeId","data-v-4e88f7c0"]]),Ga=t=>(R("data-v-b67f2147"),t=t(),X(),t),Ma={class:"nameList"},Oa={class:"ipTable"},za={class:"btnGroup"},Fa=Ga(()=>s("div",{class:"segment"},null,-1)),Ya=O({__name:"index",setup(t){const L=A(0),k=A(0);function r(h,c){h.appId,h.ip,h.remarks,c[0]&&de(c[0]).format("YYYY-MM-DD"),c[1]&&de(c[1]).format("YYYY-MM-DD")}return(h,c)=>{const a=j;return i(),V("div",Ma,[u(pa,{onSearch:r}),s("div",Oa,[u(pe),u(pe)]),u($a,{show:L.value},null,8,["show"]),u(Ua,{show:k.value},null,8,["show"]),s("div",za,[u(a,{class:"btn",icon:n(Ge),type:"primary",circle:"",size:"large",onClick:c[0]||(c[0]=d=>L.value++)},null,8,["icon"]),Fa,u(a,{class:"btn",icon:n(Me),type:"primary",circle:"",size:"large",onClick:c[1]||(c[1]=d=>k.value++)},null,8,["icon"])])])}}}),st=F(Ya,[["__scopeId","data-v-b67f2147"]]);export{st as default};
