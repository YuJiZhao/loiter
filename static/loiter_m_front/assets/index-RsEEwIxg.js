import{c as ue,E as M}from"./el-button-C0k8b0Uu.js";import{E as de}from"./el-pagination-D1tgt_kk.js";import{E as le}from"./el-input-Bl7HZI7a.js";import{E as oe,a as ne}from"./el-select-B6CuLMMT.js";import"./el-popper-BcKKSjAX.js";import{d as E,m as re,a as m,c as w,b as e,e as i,y as ie,F as _e,av as me,D as ae,aw as fe,q as J,f as o,a6 as K,aq as ve,t as D,ai as he,a7 as ge,K as R,o as Q,w as p,U as L,aa as z,n as B,h as S,i as G,j as N,E as c,at as W,au as X,ax as H,r as A,L as Y,ay as P,az as se,aA as ye,aB as pe,aC as Z,R as Ie,S as $e}from"./index-PF-Fl51z.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as be}from"./el-popover-BhCcHf01.js";import{E as ee}from"./el-overlay-HUXVHpxd.js";import"./index-_QU7_dNm.js";import"./vnode-D19UwqZF.js";const Ve={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},ke=["id"],we=["stop-color"],Ce=["stop-color"],Ge=["id"],Ne=["stop-color"],Ae=["stop-color"],Se=["id"],Be={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},Ee={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},xe={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},De=["fill"],Ue=["fill"],Re={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},Le=["fill"],ze=["fill"],Oe=["fill"],Pe=["fill"],Me=["fill"],je={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},qe=["fill","xlink:href"],Fe=["fill","mask"],Te=["fill"],Ke=E({name:"ImgEmpty"}),Ze=E({...Ke,setup(f){const s=re("empty"),u=ue();return(a,h)=>(m(),w("svg",Ve,[e("defs",null,[e("linearGradient",{id:`linearGradient-1-${i(u)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[e("stop",{"stop-color":`var(${i(s).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,we),e("stop",{"stop-color":`var(${i(s).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,Ce)],8,ke),e("linearGradient",{id:`linearGradient-2-${i(u)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[e("stop",{"stop-color":`var(${i(s).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,Ne),e("stop",{"stop-color":`var(${i(s).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,Ae)],8,Ge),e("rect",{id:`path-3-${i(u)}`,x:"0",y:"0",width:"17",height:"36"},null,8,Se)]),e("g",Be,[e("g",Ee,[e("g",xe,[e("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${i(s).cssVarBlockName("fill-color-3")})`},null,8,De),e("polygon",{id:"Rectangle-Copy-14",fill:`var(${i(s).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,Ue),e("g",Re,[e("polygon",{id:"Rectangle-Copy-10",fill:`var(${i(s).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,Le),e("polygon",{id:"Rectangle-Copy-11",fill:`var(${i(s).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,ze),e("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${i(u)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,Oe),e("polygon",{id:"Rectangle-Copy-13",fill:`var(${i(s).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,Pe)]),e("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${i(u)})`,x:"13",y:"45",width:"40",height:"36"},null,8,Me),e("g",je,[e("use",{id:"Mask",fill:`var(${i(s).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${i(u)}`},null,8,qe),e("polygon",{id:"Rectangle-Copy",fill:`var(${i(s).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${i(u)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,Fe)]),e("polygon",{id:"Rectangle-Copy-18",fill:`var(${i(s).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,Te)])])])]))}});var He=ie(Ze,[["__file","img-empty.vue"]]);const Je=_e({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Qe=["src"],We={key:1},Xe=E({name:"ElEmpty"}),Ye=E({...Xe,props:Je,setup(f){const s=f,{t:u}=me(),a=re("empty"),h=ae(()=>s.description||u("el.table.emptyText")),I=ae(()=>({width:fe(s.imageSize)}));return(r,$)=>(m(),w("div",{class:K(i(a).b())},[e("div",{class:K(i(a).e("image")),style:ve(i(I))},[r.image?(m(),w("img",{key:0,src:r.image,ondragstart:"return false"},null,8,Qe)):J(r.$slots,"image",{key:1},()=>[o(He)])],6),e("div",{class:K(i(a).e("description"))},[r.$slots.description?J(r.$slots,"description",{key:0}):(m(),w("p",We,D(i(h)),1))],2),r.$slots.default?(m(),w("div",{key:0,class:K(i(a).e("bottom"))},[J(r.$slots,"default")],2)):he("v-if",!0)],2))}});var et=ie(Ye,[["__file","empty.vue"]]);const tt=ge(et),te=f=>(W("data-v-c62459af"),f=f(),X(),f),at={class:"condition"},st=te(()=>e("span",{class:"label"},"应用名",-1)),lt=te(()=>e("span",{class:"label"},"类型",-1)),ot=te(()=>e("span",{class:"label"},"状态",-1)),nt=E({__name:"condition",emits:["search"],setup(f,{emit:s}){const u=s,a=R([]),h=R([]),I=R([]),r=R({appId:"",appGenre:"",status:""});function $(){G.getAppDictionary().then(({code:b,msg:d,data:_})=>{if(b!=N.success){c({type:"error",message:"应用信息获取失败："+d});return}_.forEach((V,v)=>{a[v]={label:V.label,value:V.value}})})}function t(){G.getAppGenreDictionary().then(({code:b,msg:d,data:_})=>{if(b!=N.success){c({type:"error",message:"应用类型字典获取失败："+d});return}_.forEach((V,v)=>{h[v]=V})})}function g(){G.getStatusDictionary().then(({code:b,msg:d,data:_})=>{if(b!=N.success){c({type:"error",message:"状态字典获取失败："+d});return}_.forEach((V,v)=>{I[v]=V})})}function C(){u("search",r)}return Q(()=>{$(),t(),g()}),(b,d)=>{const _=oe,V=ne,v=M;return m(),w("div",at,[st,o(V,{class:"input",modelValue:r.appId,"onUpdate:modelValue":d[0]||(d[0]=l=>r.appId=l),filterable:"",clearable:""},{default:p(()=>[(m(!0),w(L,null,z(a,l=>(m(),B(_,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),lt,o(V,{class:"input",modelValue:r.appGenre,"onUpdate:modelValue":d[1]||(d[1]=l=>r.appGenre=l),filterable:"",clearable:""},{default:p(()=>[(m(!0),w(L,null,z(h,l=>(m(),B(_,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),ot,o(V,{class:"input",modelValue:r.status,"onUpdate:modelValue":d[2]||(d[2]=l=>r.status=l),clearable:""},{default:p(()=>[(m(!0),w(L,null,z(I,l=>(m(),B(_,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(v,{class:"search",plain:"",onClick:C},{default:p(()=>[S("查询")]),_:1})])}}}),rt=F(nt,[["__scopeId","data-v-c62459af"]]),it=e("div",null," 暂无 ",-1),pt={class:"dialog-footer"},ct=E({__name:"api",props:{show:Number,appId:Number},setup(f){const s=f,u=H(),a=A(!1);Y(()=>s.show,r=>{h(),a.value=!0});function h(){G.getAppApiInfoById([s.appId]).then(({code:r,msg:$,data:t})=>{if(r!=N.success){c({type:"error",message:"获取应用api配置失败："+$});return}console.log(t)})}function I(){if(!u.checkAuth(P.admin)){c({type:"error",message:"权限不足！"});return}c({type:"success",message:"保存成功"}),a.value=!1}return(r,$)=>{const t=M,g=ee;return m(),B(g,{class:"api",modelValue:a.value,"onUpdate:modelValue":$[1]||($[1]=C=>a.value=C),title:"应用api配置项",width:"500"},{footer:p(()=>[e("div",pt,[o(t,{onClick:$[0]||($[0]=C=>a.value=!1)},{default:p(()=>[S("取消")]),_:1}),o(t,{type:"primary",onClick:I},{default:p(()=>[S("保存")]),_:1})])]),default:p(()=>[it]),_:1},8,["modelValue"])}}}),ut=f=>(W("data-v-981c3952"),f=f(),X(),f),dt={class:"inputGroup"},_t=ut(()=>e("span",{class:"label"},"默认错误定向",-1)),mt={class:"dialog-footer"},ft=E({__name:"static",props:{show:Number,appId:Number},setup(f){const s=f,u=H(),a=A(!1),h=R({errorRoute:""});Y(()=>s.show,t=>{$(),I(),a.value=!0});function I(){G.getAppStaticInfoById([s.appId]).then(({code:t,msg:g,data:C})=>{if(t!=N.success){c({type:"error",message:"获取应用static配置失败："+g});return}h.errorRoute=C.errorRoute})}function r(){if(!u.checkAuth(P.admin)){c({type:"error",message:"权限不足！"});return}G.saveStaticApp({...h,appId:s.appId?Number(s.appId):null}).then(({code:t,msg:g})=>{if(t!=N.success){c({type:"error",message:"保存失败："+g});return}a.value=!1,c({type:"success",message:"保存成功"})})}function $(){h.errorRoute=""}return(t,g)=>{const C=le,b=M,d=ee;return m(),B(d,{class:"static",modelValue:a.value,"onUpdate:modelValue":g[2]||(g[2]=_=>a.value=_),title:"应用static配置项",width:"500"},{footer:p(()=>[e("div",mt,[o(b,{onClick:g[1]||(g[1]=_=>a.value=!1)},{default:p(()=>[S("取消")]),_:1}),o(b,{type:"primary",onClick:r},{default:p(()=>[S("保存")]),_:1})])]),default:p(()=>[e("div",null,[e("div",dt,[_t,o(C,{class:"input",modelValue:h.errorRoute,"onUpdate:modelValue":g[0]||(g[0]=_=>h.errorRoute=_),placeholder:"默认错误定向",clearable:""},null,8,["modelValue"])])])]),_:1},8,["modelValue"])}}}),vt=F(ft,[["__scopeId","data-v-981c3952"]]),ht={class:"appCard"},gt={class:"header"},yt={class:"title"},It={class:"body"},$t={class:"line"},bt={class:"line"},Vt={class:"line"},kt={class:"remarks"},wt={class:"footer"},Ct=E({__name:"appCard",props:{data:Object},emits:["reload","activate","edit"],setup(f,{emit:s}){const u=s,a=f,h=H(),I=A(0),r=A(0);function $(){if(!h.checkAuth(P.admin)){c({type:"error",message:"权限不足"});return}G.refreshAppContainer([a.data.appId]).then(({code:d,msg:_})=>{if(d!=N.success){c({type:"error",message:"应用服务实例容器刷新失败："+_});return}c({type:"success",message:"应用服务实例容器刷新成功"})})}function t(){if(!h.checkAuth(P.admin)){c({type:"error",message:"权限不足"});return}G.activateApp({appId:a.data.appId}).then(({code:d,msg:_})=>{if(d!=N.success){c({type:"error",message:"应用状态变更失败："+_});return}u("reload")})}function g(){u("edit",a.data.appId)}function C(){if(!h.checkAuth(P.admin)){c({type:"error",message:"权限不足"});return}G.deleteApp({appId:a.data.appId}).then(({code:d,msg:_})=>{if(d!=N.success){c({type:"error",message:"删除应用失败："+_});return}u("reload")})}function b(){a.data&&(a.data.appGenre==se.api?I.value++:a.data.appGenre==se.static?r.value++:c({type:"error",message:`非法应用类型 ${a.data.appGenre} !`}))}return(d,_)=>{const V=M,v=be;return m(),w("div",ht,[e("div",gt,[e("div",yt,D(a.data.appName+"（"+a.data.host+"）"),1)]),e("div",It,[e("div",$t,[e("div",null,[S("应用类型: "),e("span",{class:"genre",onClick:b},D(a.data.appGenre),1)]),e("div",null,"服务实例: "+D(a.data.validServerNum+"/"+a.data.serverNum),1)]),e("div",bt,[e("div",null,"插件数: "+D(a.data.plugins),1),e("div",null,"责任人: "+D(a.data.owner),1)]),e("div",Vt,[e("div",null,"状态: "+D(a.data.status),1),e("div",null,"创建时间: "+D(a.data.createdAt),1)]),e("div",kt," 备注: "+D(a.data.remarks),1)]),e("div",wt,[o(v,{title:"确认刷新容器吗?",onConfirm:$},{reference:p(()=>[o(V,{class:"appBtn",plain:""},{default:p(()=>[S("刷新容器")]),_:1})]),_:1}),o(v,{title:"确认应用状态吗?",onConfirm:t},{reference:p(()=>[o(V,{class:"appBtn",plain:""},{default:p(()=>[S("切换状态")]),_:1})]),_:1}),o(V,{class:"appBtn",plain:"",onClick:g},{default:p(()=>[S("编辑")]),_:1}),o(v,{title:"确认删除该应用吗?",onConfirm:C},{reference:p(()=>[o(V,{class:"appBtn",plain:""},{default:p(()=>[S("删除")]),_:1})]),_:1})]),o(ct,{show:I.value,appId:a.data.appId},null,8,["show","appId"]),o(vt,{show:r.value,appId:a.data.appId},null,8,["show","appId"])])}}}),Gt=F(Ct,[["__scopeId","data-v-25fa345c"]]),j=f=>(W("data-v-817bcaaa"),f=f(),X(),f),Nt={class:"inputGroup"},At=j(()=>e("span",{class:"label"},"应用名",-1)),St={class:"inputGroup"},Bt=j(()=>e("span",{class:"label"},"应用类型",-1)),Et={class:"inputGroup"},xt=j(()=>e("span",{class:"label"},"代理地址",-1)),Dt={class:"inputGroup"},Ut=j(()=>e("span",{class:"label"},"责任人",-1)),Rt={class:"inputGroup"},Lt=j(()=>e("span",{class:"label"},"代理实例",-1)),zt={class:"input"},Ot={class:"addServer"},Pt={class:"inputGroup"},Mt=j(()=>e("span",{class:"label"},"备注",-1)),jt={class:"dialog-footer"},qt=E({__name:"save",props:{show:Number,flag:Number,appId:Number},emits:["reload"],setup(f,{emit:s}){const u=s,a=f,h=H(),I=A(!1),r=R([]),$=R([]),t=R({appId:0,appName:"",appGenre:"",host:"",serverList:[{address:"",weight:null}],ownerId:null,remarks:""});Y(()=>a.show,l=>{V(),a.flag==Z.update&&v(),I.value=!0});function g(){t.serverList.push({address:"",weight:null})}function C(l){if(t.serverList.length<=1){c({type:"warning",message:"服务实例不能为空"});return}t.serverList.splice(l,1)}function b(){G.getAppGenreDictionary().then(({code:l,msg:n,data:k})=>{if(l!=N.success){c({type:"error",message:"应用类型字典获取失败："+n});return}k.forEach((x,U)=>{r[U]=x})})}function d(){G.getAllUser().then(({code:l,msg:n,data:k})=>{if(l!=N.success){c({type:"error",message:"用户信息获取失败："+n});return}k.forEach((x,U)=>{$[U]={label:x.label,value:x.value}})})}function _(){if(!h.checkAuth(P.admin)){c({type:"error",message:"权限不足！"});return}for(let l in t.serverList){let n=Number(t.serverList[l].weight);if(n==null&&n<=0){c({type:"error",message:"权重值必填且不能小于1"});return}t.serverList[l].weight=n}t.ownerId=Number(t.ownerId),G.saveApp({...t}).then(({code:l,msg:n})=>{if(l!=N.success){c({type:"error",message:"保存失败："+n});return}I.value=!1,u("reload")})}function V(){t.appId=0,t.appName="",t.appGenre="",t.host="",t.serverList=[{address:"",weight:null}],t.ownerId=null,t.remarks=""}function v(){t.appId=a.appId,G.getAppInfoById([a.appId]).then(({code:l,msg:n,data:k})=>{if(l!=N.success){c({type:"error",message:"获取应用详细信息失败"+n});return}t.appName=k.appName,t.appGenre=k.appGenre,t.host=k.host,t.serverList=k.serverList,t.ownerId=String(k.ownerId),t.remarks=k.remarks})}return Q(()=>{b(),d()}),(l,n)=>{const k=le,x=oe,U=ne,O=M,ce=ee;return m(),B(ce,{class:"save",modelValue:I.value,"onUpdate:modelValue":n[6]||(n[6]=y=>I.value=y),title:a.flag==i(Z).add?"新增应用":"编辑应用",width:"500"},{footer:p(()=>[e("div",jt,[o(O,{onClick:n[5]||(n[5]=y=>I.value=!1)},{default:p(()=>[S("取消")]),_:1}),o(O,{type:"primary",onClick:_},{default:p(()=>[S("保存")]),_:1})])]),default:p(()=>[e("div",null,[e("div",Nt,[At,o(k,{class:"input",modelValue:t.appName,"onUpdate:modelValue":n[0]||(n[0]=y=>t.appName=y),clearable:""},null,8,["modelValue"])]),e("div",St,[Bt,o(U,{class:"input",modelValue:t.appGenre,"onUpdate:modelValue":n[1]||(n[1]=y=>t.appGenre=y),clearable:""},{default:p(()=>[(m(!0),w(L,null,z(r,y=>(m(),B(x,{key:y.value,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",Et,[xt,o(k,{class:"input",modelValue:t.host,"onUpdate:modelValue":n[2]||(n[2]=y=>t.host=y),clearable:""},{prepend:p(()=>[S("http://")]),_:1},8,["modelValue"])]),e("div",Dt,[Ut,o(U,{class:"input",modelValue:t.ownerId,"onUpdate:modelValue":n[3]||(n[3]=y=>t.ownerId=y),clearable:""},{default:p(()=>[(m(!0),w(L,null,z($,y=>(m(),B(x,{key:y.value,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",Rt,[Lt,e("div",zt,[(m(!0),w(L,null,z(t.serverList,(y,q)=>(m(),B(k,{class:"serverInput",modelValue:t.serverList[q].address,"onUpdate:modelValue":T=>t.serverList[q].address=T,placeholder:"地址",clearable:""},{prepend:p(()=>[o(k,{class:"weightInput",modelValue:t.serverList[q].weight,"onUpdate:modelValue":T=>t.serverList[q].weight=T,placeholder:"权重",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),append:p(()=>[o(O,{icon:i(ye),circle:"",size:"small",onClick:T=>C(q)},null,8,["icon","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),256))])]),e("div",Ot,[o(O,{icon:i(pe),circle:"",size:"small",onClick:g},null,8,["icon"])]),e("div",Pt,[Mt,o(k,{class:"input",type:"textarea",modelValue:t.remarks,"onUpdate:modelValue":n[4]||(n[4]=y=>t.remarks=y),autosize:"",clearable:""},null,8,["modelValue"])])])]),_:1},8,["modelValue","title"])}}}),Ft=F(qt,[["__scopeId","data-v-817bcaaa"]]),Tt={class:"application"},Kt={class:"appGroup"},Zt="prev, pager, next",Ht=E({__name:"index",setup(f){let s={appId:"",appGenre:"",status:""};const u=A(1),a=A(9),h=A([]),I=A(0),r=A(!0),$=A(0),t=A(),g=A(0);function C(v){s.appId=v.appId,s.appGenre=v.appGenre,s.status=v.status,b()}function b(){G.getAppInfoByPage({appId:s.appId?Number(s.appId):null,appGenre:s.appGenre,status:s.status?Number(s.status):null,pageNo:u.value,pageSize:a.value}).then(({code:v,msg:l,data:n})=>{if(v!=N.success){c({type:"error",message:"应用详细信息获取失败："+l});return}r.value=n.data==null||n.data.length==0,h.value=n.data,I.value=n.total})}function d(v){u.value=v,b()}function _(){t.value=Z.add,g.value=0,$.value++}function V(v){t.value=Z.update,g.value=v,$.value++}return Q(()=>{b()}),(v,l)=>{const n=tt,k=de,x=M;return m(),w("div",Tt,[o(rt,{onSearch:C}),e("div",Kt,[(m(!0),w(L,null,z(h.value,(U,O)=>(m(),B(Gt,{class:"appCard",key:O,data:U,onReload:b,onEdit:V},null,8,["data"]))),128))]),Ie(o(n,{description:"暂无应用配置"},null,512),[[$e,r.value]]),o(k,{class:"pagination",layout:Zt,"current-page":u.value,"page-size":a.value,total:I.value,onCurrentChange:d},null,8,["current-page","page-size","total"]),o(x,{class:"saveBtn",icon:i(pe),type:"primary",circle:"",size:"large",onClick:_},null,8,["icon"]),o(Ft,{show:$.value,flag:t.value,appId:g.value,onReload:b},null,8,["show","flag","appId"])])}}}),na=F(Ht,[["__scopeId","data-v-12ed4025"]]);export{na as default};
