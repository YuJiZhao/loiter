<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>耶瞳职库</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.png">
    <script src="/script/statistics.js"></script>
    <script src="/script/console.js"></script>
    <meta name="description" content="耶瞳职库，再不学就要失业了">
    
    <link rel="preload" href="/assets/css/0.styles.58b00068.css" as="style"><link rel="preload" href="/assets/js/app.e1d38c41.js" as="script"><link rel="preload" href="/assets/js/2.ccf64a40.js" as="script"><link rel="preload" href="/assets/js/1.ff36f1ce.js" as="script"><link rel="preload" href="/assets/js/26.56a69cea.js" as="script"><link rel="prefetch" href="/assets/js/10.05dae71d.js"><link rel="prefetch" href="/assets/js/100.fb3d4a6b.js"><link rel="prefetch" href="/assets/js/101.7d607fdc.js"><link rel="prefetch" href="/assets/js/102.ee2d116c.js"><link rel="prefetch" href="/assets/js/103.b8b835d6.js"><link rel="prefetch" href="/assets/js/104.893253b2.js"><link rel="prefetch" href="/assets/js/105.bbbfb931.js"><link rel="prefetch" href="/assets/js/106.951d9da2.js"><link rel="prefetch" href="/assets/js/107.c93f5de5.js"><link rel="prefetch" href="/assets/js/108.8b79d46d.js"><link rel="prefetch" href="/assets/js/109.44a71d8d.js"><link rel="prefetch" href="/assets/js/11.9ef2020a.js"><link rel="prefetch" href="/assets/js/110.45c28aa0.js"><link rel="prefetch" href="/assets/js/111.1a54f6a9.js"><link rel="prefetch" href="/assets/js/112.6b8237dc.js"><link rel="prefetch" href="/assets/js/113.4cc54908.js"><link rel="prefetch" href="/assets/js/114.cfe5914d.js"><link rel="prefetch" href="/assets/js/115.fb07f653.js"><link rel="prefetch" href="/assets/js/116.52e5791a.js"><link rel="prefetch" href="/assets/js/117.35b71c87.js"><link rel="prefetch" href="/assets/js/118.06ca1c5a.js"><link rel="prefetch" href="/assets/js/119.39911a0d.js"><link rel="prefetch" href="/assets/js/12.6f5a3671.js"><link rel="prefetch" href="/assets/js/120.e4dd4eb0.js"><link rel="prefetch" href="/assets/js/121.5aa985f7.js"><link rel="prefetch" href="/assets/js/122.9204d776.js"><link rel="prefetch" href="/assets/js/123.53b3bc5d.js"><link rel="prefetch" href="/assets/js/124.505a1825.js"><link rel="prefetch" href="/assets/js/125.bb09dc4e.js"><link rel="prefetch" href="/assets/js/126.d376fb4b.js"><link rel="prefetch" href="/assets/js/127.5dbe04cf.js"><link rel="prefetch" href="/assets/js/128.5251e742.js"><link rel="prefetch" href="/assets/js/129.92395fd3.js"><link rel="prefetch" href="/assets/js/13.55d1ddfd.js"><link rel="prefetch" href="/assets/js/130.1f2abc8d.js"><link rel="prefetch" href="/assets/js/131.a4dc1572.js"><link rel="prefetch" href="/assets/js/132.fe417fec.js"><link rel="prefetch" href="/assets/js/133.26d84358.js"><link rel="prefetch" href="/assets/js/134.9bae45d3.js"><link rel="prefetch" href="/assets/js/135.f4334d70.js"><link rel="prefetch" href="/assets/js/136.b9133e25.js"><link rel="prefetch" href="/assets/js/137.4404c47d.js"><link rel="prefetch" href="/assets/js/14.7d6475ac.js"><link rel="prefetch" href="/assets/js/15.bade5a53.js"><link rel="prefetch" href="/assets/js/16.bdf52384.js"><link rel="prefetch" href="/assets/js/17.cfe35a34.js"><link rel="prefetch" href="/assets/js/18.94d03c89.js"><link rel="prefetch" href="/assets/js/19.437ee15d.js"><link rel="prefetch" href="/assets/js/20.ca3c2e96.js"><link rel="prefetch" href="/assets/js/21.3a9a9f37.js"><link rel="prefetch" href="/assets/js/22.392bccf8.js"><link rel="prefetch" href="/assets/js/23.af691550.js"><link rel="prefetch" href="/assets/js/24.916ac209.js"><link rel="prefetch" href="/assets/js/25.718b6d13.js"><link rel="prefetch" href="/assets/js/27.478d4f53.js"><link rel="prefetch" href="/assets/js/28.b115be10.js"><link rel="prefetch" href="/assets/js/29.488fca25.js"><link rel="prefetch" href="/assets/js/3.9f6b3b4e.js"><link rel="prefetch" href="/assets/js/30.40f0dcc3.js"><link rel="prefetch" href="/assets/js/31.96122f56.js"><link rel="prefetch" href="/assets/js/32.b9eda3a1.js"><link rel="prefetch" href="/assets/js/33.55da7336.js"><link rel="prefetch" href="/assets/js/34.7ace5cdd.js"><link rel="prefetch" href="/assets/js/35.666cd4b6.js"><link rel="prefetch" href="/assets/js/36.1394eebd.js"><link rel="prefetch" href="/assets/js/37.6cbcd728.js"><link rel="prefetch" href="/assets/js/38.7a68a97a.js"><link rel="prefetch" href="/assets/js/39.32d96cdb.js"><link rel="prefetch" href="/assets/js/4.8e2a25d9.js"><link rel="prefetch" href="/assets/js/40.4dac9d29.js"><link rel="prefetch" href="/assets/js/41.62a7f5a9.js"><link rel="prefetch" href="/assets/js/42.d89fc9bd.js"><link rel="prefetch" href="/assets/js/43.71e5e6bb.js"><link rel="prefetch" href="/assets/js/44.203f7f19.js"><link rel="prefetch" href="/assets/js/45.1ebfb4a7.js"><link rel="prefetch" href="/assets/js/46.d75ebd2d.js"><link rel="prefetch" href="/assets/js/47.cdcaa0bb.js"><link rel="prefetch" href="/assets/js/48.aed0339e.js"><link rel="prefetch" href="/assets/js/49.a3ba2fb4.js"><link rel="prefetch" href="/assets/js/5.c429486a.js"><link rel="prefetch" href="/assets/js/50.e94adb4b.js"><link rel="prefetch" href="/assets/js/51.6ba3d73f.js"><link rel="prefetch" href="/assets/js/52.b6f1b461.js"><link rel="prefetch" href="/assets/js/53.991d59cc.js"><link rel="prefetch" href="/assets/js/54.c2e6c2fe.js"><link rel="prefetch" href="/assets/js/55.417a9a65.js"><link rel="prefetch" href="/assets/js/56.32781dfe.js"><link rel="prefetch" href="/assets/js/57.4f393e70.js"><link rel="prefetch" href="/assets/js/58.0beecda2.js"><link rel="prefetch" href="/assets/js/59.a63b6dfd.js"><link rel="prefetch" href="/assets/js/6.beb44280.js"><link rel="prefetch" href="/assets/js/60.8dfcf03e.js"><link rel="prefetch" href="/assets/js/61.1fe9d14e.js"><link rel="prefetch" href="/assets/js/62.45358503.js"><link rel="prefetch" href="/assets/js/63.67657d2f.js"><link rel="prefetch" href="/assets/js/64.82f19936.js"><link rel="prefetch" href="/assets/js/65.d3a04345.js"><link rel="prefetch" href="/assets/js/66.53ea5948.js"><link rel="prefetch" href="/assets/js/67.2d4edf55.js"><link rel="prefetch" href="/assets/js/68.ef3f7aa5.js"><link rel="prefetch" href="/assets/js/69.56362da6.js"><link rel="prefetch" href="/assets/js/7.3b16f0e9.js"><link rel="prefetch" href="/assets/js/70.104e1293.js"><link rel="prefetch" href="/assets/js/71.cc5bdea6.js"><link rel="prefetch" href="/assets/js/72.70236fa4.js"><link rel="prefetch" href="/assets/js/73.573dbdea.js"><link rel="prefetch" href="/assets/js/74.1be41fbb.js"><link rel="prefetch" href="/assets/js/75.c7410bfb.js"><link rel="prefetch" href="/assets/js/76.2c665a29.js"><link rel="prefetch" href="/assets/js/77.625f82ee.js"><link rel="prefetch" href="/assets/js/78.ff6a7ea7.js"><link rel="prefetch" href="/assets/js/79.1985583b.js"><link rel="prefetch" href="/assets/js/80.d265d5b5.js"><link rel="prefetch" href="/assets/js/81.74b4621f.js"><link rel="prefetch" href="/assets/js/82.15b7c14d.js"><link rel="prefetch" href="/assets/js/83.7637a0f4.js"><link rel="prefetch" href="/assets/js/84.949b34ad.js"><link rel="prefetch" href="/assets/js/85.93dccc96.js"><link rel="prefetch" href="/assets/js/86.01c14aed.js"><link rel="prefetch" href="/assets/js/87.0ff1318b.js"><link rel="prefetch" href="/assets/js/88.b90d420d.js"><link rel="prefetch" href="/assets/js/89.28f92555.js"><link rel="prefetch" href="/assets/js/90.24991471.js"><link rel="prefetch" href="/assets/js/91.127fb5d4.js"><link rel="prefetch" href="/assets/js/92.a4e2fda5.js"><link rel="prefetch" href="/assets/js/93.988d3aef.js"><link rel="prefetch" href="/assets/js/94.3e2515a8.js"><link rel="prefetch" href="/assets/js/95.cb59d6fe.js"><link rel="prefetch" href="/assets/js/96.3577f8f0.js"><link rel="prefetch" href="/assets/js/97.00ee8a0e.js"><link rel="prefetch" href="/assets/js/98.164b95f4.js"><link rel="prefetch" href="/assets/js/99.1a5bcb9c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5a4296f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.58b00068.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">耶瞳职库</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vitae/" class="nav-link">
  简历
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="八股" class="dropdown-title"><span class="title">八股</span> <span class="arrow down"></span></button> <button type="button" aria-label="八股" class="mobile-dropdown-title"><span class="title">八股</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stereotype/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/mq/" class="nav-link">
  消息队列
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/operating-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手撕" class="dropdown-title"><span class="title">手撕</span> <span class="arrow down"></span></button> <button type="button" aria-label="手撕" class="mobile-dropdown-title"><span class="title">手撕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/handTearing/algorithm-interview/" class="nav-link">
  面试算法
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/algorithm-written-test/" class="nav-link">
  笔试算法
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/brain-teaser/" class="nav-link">
  智力题
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/multi-threading/" class="nav-link">
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/design-patterns/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><a href="/design/" class="nav-link router-link-active">
  系统设计
</a></div><div class="nav-item"><a href="/project/" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/work/" class="nav-link">
  工作
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面经" class="dropdown-title"><span class="title">面经</span> <span class="arrow down"></span></button> <button type="button" aria-label="面经" class="mobile-dropdown-title"><span class="title">面经</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interview/alibaba/" class="nav-link">
  阿里巴巴
</a></li><li class="dropdown-item"><!----> <a href="/interview/tencent/" class="nav-link">
  腾讯
</a></li><li class="dropdown-item"><!----> <a href="/interview/bytedance/" class="nav-link">
  字节跳动
</a></li><li class="dropdown-item"><!----> <a href="/interview/baidu/" class="nav-link">
  百度
</a></li><li class="dropdown-item"><!----> <a href="/interview/meituan/" class="nav-link">
  美团
</a></li><li class="dropdown-item"><!----> <a href="/interview/kuaishou/" class="nav-link">
  快手
</a></li><li class="dropdown-item"><!----> <a href="/interview/huawei/" class="nav-link">
  华为
</a></li><li class="dropdown-item"><!----> <a href="/interview/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/miscellany/" class="nav-link">
  杂言
</a></div><div class="nav-item"><a href="https://github.com/YuJiZhao/eyesHunt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://space.eyescode.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  耶瞳空间
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://stars.eyescode.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  耶瞳星空
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vitae/" class="nav-link">
  简历
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="八股" class="dropdown-title"><span class="title">八股</span> <span class="arrow down"></span></button> <button type="button" aria-label="八股" class="mobile-dropdown-title"><span class="title">八股</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stereotype/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/mq/" class="nav-link">
  消息队列
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/operating-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/stereotype/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手撕" class="dropdown-title"><span class="title">手撕</span> <span class="arrow down"></span></button> <button type="button" aria-label="手撕" class="mobile-dropdown-title"><span class="title">手撕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/handTearing/algorithm-interview/" class="nav-link">
  面试算法
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/algorithm-written-test/" class="nav-link">
  笔试算法
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/brain-teaser/" class="nav-link">
  智力题
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/multi-threading/" class="nav-link">
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/handTearing/design-patterns/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><a href="/design/" class="nav-link router-link-active">
  系统设计
</a></div><div class="nav-item"><a href="/project/" class="nav-link">
  项目
</a></div><div class="nav-item"><a href="/work/" class="nav-link">
  工作
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面经" class="dropdown-title"><span class="title">面经</span> <span class="arrow down"></span></button> <button type="button" aria-label="面经" class="mobile-dropdown-title"><span class="title">面经</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interview/alibaba/" class="nav-link">
  阿里巴巴
</a></li><li class="dropdown-item"><!----> <a href="/interview/tencent/" class="nav-link">
  腾讯
</a></li><li class="dropdown-item"><!----> <a href="/interview/bytedance/" class="nav-link">
  字节跳动
</a></li><li class="dropdown-item"><!----> <a href="/interview/baidu/" class="nav-link">
  百度
</a></li><li class="dropdown-item"><!----> <a href="/interview/meituan/" class="nav-link">
  美团
</a></li><li class="dropdown-item"><!----> <a href="/interview/kuaishou/" class="nav-link">
  快手
</a></li><li class="dropdown-item"><!----> <a href="/interview/huawei/" class="nav-link">
  华为
</a></li><li class="dropdown-item"><!----> <a href="/interview/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/miscellany/" class="nav-link">
  杂言
</a></div><div class="nav-item"><a href="https://github.com/YuJiZhao/eyesHunt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://space.eyescode.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  耶瞳空间
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://stars.eyescode.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  耶瞳星空
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/design/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/design/topK.html" class="sidebar-link">TopK问题</a></li><li><a href="/design/single-array-frequency-sort.html" class="sidebar-link">单数组频度排序</a></li><li><a href="/design/massive-array-frequency-sort.html" class="sidebar-link">多数组频度排序</a></li><li><a href="/design/find-mid-num.html" class="sidebar-link">查找中位数</a></li><li><a href="/design/find-same-url.html" class="sidebar-link">查找相同的url</a></li><li><a href="/design/count-phone-num.html" class="sidebar-link">统计不同号码的个数</a></li><li><a href="/design/scan-code-login.html" class="sidebar-link">扫码登录</a></li><li><a href="/design/order-timeout-auto-cancel.html" class="sidebar-link">超时订单自动取消</a></li><li><a href="/design/url-short-link.html" class="sidebar-link">短链系统设计</a></li><li><a href="/design/red-envelope.html" class="sidebar-link">微信红包系统</a></li><li><a href="/design/current-limiting.html" class="sidebar-link">限流算法</a></li><li><a href="/design/global-unique-id.html" class="sidebar-link">全局唯一id</a></li><li><a href="/design/distributed-lock.html" aria-current="page" class="active sidebar-link">分布式锁</a></li><li><a href="/design/distributed-transaction.html" class="sidebar-link">分布式事务</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>在单机环境下，当存在多个线程可以同时改变某个变量（可变共享变量）时，就会出现线程安全问题。这个问题可以通过 JAVA 提供的 volatile、ReentrantLock、synchronized 以及 concurrent 并发包下一些线程安全的类等来避免。</p> <p>而在多机部署环境，需要在多进程下保证线程的安全性，Java 提供的这些 API 仅能保证在单个 JVM 进程内对多线程访问共享资源的线程安全，已经不满足需求了。这时候就需要使用分布式锁来保证线程安全。通过分布式锁，可以保证在分布式部署的应用集群中，同一个方法在同一时间只能被一台机器上的一个线程执行。</p> <p>在分析分布式锁的三种实现方式之前，先了解一下分布式锁应该具备哪些条件：</p> <ul><li>互斥性：在任意时刻，只有一个客户端能持有锁</li> <li>不会死锁：具备锁失效机制，防止死锁，即使有客户端在持有锁的期间崩溃而没有主动解锁，也要保证后续其他客户端能加锁</li> <li>加锁和解锁必须是同一个客户端：客户端 a 不能将客户端 b 的锁解开，即不能误解锁</li> <li>高性能、高可用的获取锁与释放锁</li> <li>具备可重入特性</li> <li>具备非阻塞锁特性，即没有获取到锁将直接返回获取锁失败</li></ul> <h1 id="基于数据库实现"><a href="#基于数据库实现" class="header-anchor">#</a> 基于数据库实现</h1> <p><strong>悲观锁</strong></p> <p>创建一张锁表，然后通过操作该表中的数据来实现加锁和解锁。当要锁住某个方法或资源时，就向该表插入一条记录，表中设置方法名为唯一键，这样多个请求同时提交数据库时，只有一个操作可以成功，判定操作成功的线程获得该方法的锁，可以执行方法内容；想要释放锁的时候就删除这条记录，其他线程就可以继续往数据库中插入数据获取锁。</p> <p><strong>乐观锁</strong></p> <p>先在数据库建一张资源表，包含资源名称 resource_name、版本号 version（可以是随机数、时间戳，与锁是否过期有关）等信息，将资源名称建立唯一索引。</p> <p>执行逻辑如下：</p> <ol><li>在程序尝试上锁时，根据资源名称查询数据，获取锁的版本号也就是时间戳</li> <li>将当前时间与版本号作比较，如果当前时间大于等于版本号的时间，就以资源名称和查出来的版本号作为条件，更新数据库版本号为自己的版本号。自己的版本号就是当前时间戳加上超时时间</li> <li>如果更新返回的影响行数大于 0 就是更新成功，该线程获取了锁</li> <li>如果更新返回的影响行数不大于 0 就是更新失败，该线程无法获取锁，然后睡眠一定时间再重试。我们可以设置重试时间，如果超过时间就不再获取锁了</li> <li>如果版本号已经被更新了的话，那么其他线程以查出来的旧版本号就无法匹配得到数据行了，在这个过程中只有一个线程能够更新</li> <li>释放锁的过程就是将版本号改为当前时间戳</li></ol> <p><img src="http://hunt-cdn.eyescode.top/content/6e5d4507-9632-270c-42c6-951072478204.png" alt="乐观锁实现分布式锁"></p> <h1 id="基于redis实现"><a href="#基于redis实现" class="header-anchor">#</a> 基于Redis实现</h1> <p><strong>单机模式</strong></p> <p>加锁逻辑：</p> <ol><li>setnx 争抢 key 的锁，如果已有 key 存在，则不作操作，过段时间继续重试，保证只有一个客户端能持有锁</li> <li>value 设置为 requestId（可以使用机器 ip 拼接当前线程名称），表示这把锁是哪个请求加的，在解锁的时候需要判断当前请求是否持有锁，防止误解锁。比如客户端 A 加锁，在执行解锁之前，锁过期了，此时客户端 B 尝试加锁成功，然后客户端 A 再执行<code>del()</code>方法，则将客户端 B 的锁给解除了</li> <li>再用 expire 给锁加一个过期时间，防止异常导致锁没有释放</li></ol> <p>解锁逻辑：首先获取锁对应的 value 值，检查是否与 requestId 相等，如果相等则删除锁。使用 lua 脚本实现原子操作，保证线程安全。</p> <p>这个方案是基于 Redis 单机版的分布式锁讨论，还不是很完美。因为 Redis 一般都是集群部署的。</p> <p><strong>集群模式</strong></p> <p>集群模式下，加锁会变得复杂一点。如下图，如果线程一在 Redis 的 master 节点上拿到了锁，但是加锁的 key 还没同步到 slave 节点。恰好这时，master 节点发生故障，一个 slave 节点就会升级为 master 节点。线程二就可以顺理成章获取同个 key 的锁啦，但线程一也已经拿到锁了，锁的安全性就没了。</p> <p><img src="http://hunt-cdn.eyescode.top/content/cf3659a6-0696-8679-bb54-dc9d33f23971.png" alt="集群模式"></p> <p>为了解决这个问题，Redis 作者 antirez 提出一种高级的分布式锁算法：Redlock。它的核心思想是这样的：部署多个 Redis master，以保证它们不会同时宕掉。并且这些 master 节点是完全相互独立的，相互之间不存在数据同步。同时，需要确保在这多个 master 实例上，是与在 Redis 单实例，使用相同方法来获取和释放锁。</p> <p>我们假设当前有 5 个 Redis master 节点，在 5 台服务器上面运行这些 Redis 实例：
<img src="http://hunt-cdn.eyescode.top/content/9c482024-d9ef-1bdf-843e-4b065917d387.png" alt="集群示例"></p> <p>RedLock 的实现步骤：</p> <ol><li>获取当前时间，以毫秒为单位</li> <li>按顺序向 5 个 master 节点请求加锁。客户端设置网络连接和响应超时时间，并且超时时间要小于锁的失效时间。（假设锁自动失效时间为 10 秒，则超时时间一般在 5-50 毫秒之间,我们就假设超时时间是 50ms 吧）。如果超时，跳过该 master 节点，尽快去尝试下一个 master 节点。</li> <li>客户端使用当前时间减去开始获取锁时间（即步骤1记录的时间），得到获取锁使用的时间。当且仅当超过一半（<code>N/2+1</code>，这里是<code>5/2+1=3个</code>节点）的 Redis  master 节点都获得锁，并且使用的时间小于锁失效时间时，锁才算获取成功。（如上图，<code>10s&gt; 30ms+40ms+50ms+4m0s+50ms</code>）</li> <li>如果取到了锁，key 的真正有效时间就变啦，需要减去获取锁所使用的时间</li> <li>如果获取锁失败（没有在至少<code>N/2+1</code>个 master 实例取到锁，有或者获取锁时间已经超过了有效时间），客户端要在所有的 master 节点上解锁（即便有些 master 节点根本就没有加锁成功，也需要解锁，以防止有些漏网之鱼）。</li></ol> <p>简化下步骤就是：</p> <ol><li>按顺序向5个master节点请求加锁</li> <li>根据设置的超时时间来判断，是不是要跳过该master节点</li> <li>如果大于等于3个节点加锁成功，并且使用的时间小于锁的有效期，即可认定加锁成功</li> <li>如果获取锁失败，就解锁</li></ol> <p><strong>看门狗</strong></p> <p>上面介绍的 redis 分布式锁是无法自动续期的，比如，一个锁设置了1分钟超时释放，如果拿到这个锁的线程在一分钟内没有执行完毕，那么这个锁就会被其他线程拿到，这可能会导致严重的线上问题。为了解决这个问题，就需要有一个自动续期功能。</p> <p>Redisson 是一个开源的 Java 语言 Redis 客户端，提供了很多开箱即用的功能，不仅仅包括多种分布式锁的实现。并且，Redisson 还支持 Redis 单机、Redis Sentinel、Redis Cluster 等多种部署架构。Redisson 中的分布式锁自带自动续期机制，使用起来非常简单，原理也比较简单，其提供了一个专门用来监控和续期锁的 Watch Dog（看门狗），如果操作共享资源的线程还未执行完成的话，Watch Dog 会不断地延长锁的过期时间，进而保证锁不会因为超时而被释放。</p> <p><img src="http://hunt-cdn.eyescode.top/content/052094b1-92a7-de97-10fe-637707c65dee.jpg" alt="看门狗工作机制"></p> <h1 id="基于zookeeper实现"><a href="#基于zookeeper实现" class="header-anchor">#</a> 基于Zookeeper实现</h1> <p>ZooKeeper 分布式锁是基于 临时顺序节点 和 Watcher（事件监听器） 实现的。</p> <p>获取锁：</p> <ol><li>首先我们要有一个持久节点<code>/locks</code>，客户端获取锁就是在 locks 下创建临时顺序节点</li> <li>假设客户端 1 创建了<code>/locks/lock1</code>节点，创建成功之后，会判断 lock1 是否是<code>/locks</code>下最小的子节点</li> <li>如果 lock1 是最小的子节点，则获取锁成功。否则，获取锁失败</li> <li>如果获取锁失败，则说明有其他的客户端已经成功获取锁。客户端 1 并不会不停地循环去尝试加锁，而是在前一个节点比如<code>/locks/lock0</code>上注册一个事件监听器。这个监听器的作用是当前一个节点释放锁之后通知客户端 1（避免无效自旋），这样客户端 1 就加锁成功了</li></ol> <p>释放锁：</p> <ol><li>成功获取锁的客户端在执行完业务流程之后，会将对应的子节点删除</li> <li>成功获取锁的客户端在出现故障之后，对应的子节点由于是临时顺序节点，也会被自动删除，避免了锁无法被释放</li> <li>我们前面说的事件监听器其实监听的就是这个子节点删除事件，子节点删除就意味着锁被释放</li></ol> <p><img src="http://hunt-cdn.eyescode.top/content/5a2b5ce3-fb00-c4a0-e466-bc6165a1e98f.png" alt="zookeeper分布式锁"></p> <p>实际项目中，推荐使用 Curator 来实现 ZooKeeper 分布式锁。Curator 是 Netflix 公司开源的一套 ZooKeeper Java 客户端框架，相比于 ZooKeeper 自带的客户端 zookeeper 来说，Curator 的封装更加完善，各种 API 都可以比较方便地使用。</p> <p><strong>为什么要用临时顺序节点？</strong></p> <p>每个数据节点在 ZooKeeper 中被称为 znode，它是 ZooKeeper 中数据的最小单元。我们通常是将 znode 分为 4 大类：</p> <ul><li>持久（PERSISTENT）节点：一旦创建，即使 ZooKeeper 集群宕机它也一直存在，直到将其删除</li> <li>临时（EPHEMERAL）节点：临时节点的生命周期是与客户端会话（session）绑定的，会话消失则节点消失。并且临时节点只能做叶子节点，不能创建子节点</li> <li>持久顺序（PERSISTENT_SEQUENTIAL）节点：除了具有持久节点的特性之外，子节点的名称还具有顺序性。比如<code>/node1/app0000000001</code>、<code>/node1/app0000000002</code></li> <li>临时顺序（EPHEMERAL_SEQUENTIAL）节点：除了具备临时节点的特性之外，子节点的名称还具有顺序性</li></ul> <p>可以看出，临时节点相比持久节点，最主要的是对会话失效的情况处理不一样，临时节点会话消失则对应的节点消失。这样的话，如果客户端发生异常导致没来得及释放锁也没关系，会话失效节点自动被删除，不会发生死锁的问题。</p> <p>使用 Redis 实现分布式锁的时候，我们是通过过期时间来避免锁无法被释放导致死锁问题的，而 ZooKeeper 直接利用临时节点的特性即可。</p> <p>假设不使用顺序节点的话，所有尝试获取锁的客户端都会对持有锁的子节点加监听器。当该锁被释放之后，势必会造成所有尝试获取锁的客户端来争夺锁，这样对性能不友好。使用顺序节点之后，只需要监听前一个节点就好了，对性能更友好。</p> <p><strong>为什么要设置对前一个节点的监听？</strong></p> <blockquote><p>Watcher（事件监听器），是 ZooKeeper 中的一个很重要的特性。ZooKeeper 允许用户在指定节点上注册一些 Watcher，并且在一些特定事件触发的时候，ZooKeeper 服务端会将事件通知到感兴趣的客户端上去，该机制是 ZooKeeper 实现分布式协调服务的重要特性。</p></blockquote> <p>同一时间段内，可能会有很多客户端同时获取锁，但只有一个可以获取成功。如果获取锁失败，则说明有其他的客户端已经成功获取锁。获取锁失败的客户端并不会不停地循环去尝试加锁，而是在前一个节点注册一个事件监听器。</p> <p>这个事件监听器的作用是：当前一个节点对应的客户端释放锁之后（也就是前一个节点被删除之后，监听的是删除事件），通知获取锁失败的客户端（唤醒等待的线程，Java 中的 wait/notifyAll ），让它尝试去获取锁，然后就成功获取锁了。</p> <h1 id="方案对比"><a href="#方案对比" class="header-anchor">#</a> 方案对比</h1> <p>数据库分布式锁实现：</p> <ul><li>优点：
<ul><li>简单，使用方便，不需要引入 Redis、zookeeper 等中间件</li></ul></li> <li>缺点：
<ul><li>不适合高并发的场景</li> <li>db操作性能较差</li></ul></li></ul> <p>Redis分布式锁实现：</p> <ul><li>优点：
<ul><li>性能好，适合高并发场景</li> <li>较轻量级</li> <li>有较好的框架支持，如 Redisson</li></ul></li> <li>缺点：
<ul><li>过期时间不好控制</li> <li>需要考虑锁被别的线程误删场景</li></ul></li></ul> <p>Zookeeper 分布式锁实现</p> <ul><li>优点：
<ul><li>有较好的性能和可靠性</li> <li>有封装较好的框架，如 Curator</li></ul></li> <li>缺点：
<ul><li>性能不如 redis 实现的分布式锁</li> <li>比较重</li></ul></li></ul> <p>对比汇总：</p> <ul><li>从性能角度（从高到低）：Redis &gt; Zookeeper &gt;= 数据库</li> <li>从理解的难易程度角度（从低到高）：数据库 &gt; Redis &gt; Zookeeper</li> <li>从实现的复杂性角度（从低到高）：Zookeeper &gt; Redis &gt; 数据库</li> <li>从可靠性角度（从高到低）：Zookeeper &gt; Redis &gt; 数据库</li></ul> <hr> <p>摘自：</p> <ul><li><a href="https://www.topjavaer.cn/advance/distributed/2-distributed-lock.html" target="_blank" rel="noopener noreferrer">分布式锁<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://javaguide.cn/distributed-system/distributed-lock-implementations.html" target="_blank" rel="noopener noreferrer">分布式锁常见实现方案总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_45973130/article/details/120555676" target="_blank" rel="noopener noreferrer">java分布式锁 - 基于数据库表实现乐观锁（三）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/jelly12345/p/14699492.html" target="_blank" rel="noopener noreferrer">redisson中的看门狗机制总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>站长略有修改</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/22/2023, 1:18:03 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/design/global-unique-id.html" class="prev">
        全局唯一id
      </a></span> <span class="next"><a href="/design/distributed-transaction.html">
        分布式事务
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e1d38c41.js" defer></script><script src="/assets/js/2.ccf64a40.js" defer></script><script src="/assets/js/1.ff36f1ce.js" defer></script><script src="/assets/js/26.56a69cea.js" defer></script>
  </body>
</html>
