(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{416:function(e,r,t){"use strict";t.r(r);var a=t(10),s=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"定位耗时节点"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#定位耗时节点"}},[e._v("#")]),e._v(" 定位耗时节点")]),e._v(" "),r("p",[e._v("定位性能瓶颈有两个思路，一个是通过工具去监控，一个是通过经验去猜想。")]),e._v(" "),r("p",[e._v("就工具而言，推荐使用 "),r("a",{attrs:{href:"https://arthas.aliyun.com/doc",target:"_blank",rel:"noopener noreferrer"}},[e._v("arthas"),r("OutboundLink")],1),e._v("。具体安装适用这里就不多介绍了，可以查看官方文档，如果是在阿里工作的话，arthas 可以说是必备技能。")]),e._v(" "),r("p",[e._v("arthas 的 trace 命令可以查看当前方法内，各个子函数的耗时情况，如下：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("trace com.xxx.service.impl.AServiceImpl refresh\n")])])]),r("p",[e._v("其中耗时最多的子函数会被标红色：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("Affect(class-cnt:2 , method-cnt:2) cost in 525 ms.\n`---ts=2020-0X-0Y 13:33:18;thread_name=DubboServerHandler-127.0.0.1:20880-thread-36;id=24e;is_daemon=true;priority=5;TCCL=com.mmm.WWWClassLoader@4362d7df\n    `---[1761.834357ms] com.xxx.service.impl.AServiceImpl$$EnhancerBySpringCGLIB$$e3cd7543:refresh()\n        +---[0.017066ms] com.xxx.service.impl.AServiceImpl$$EnhancerBySpringCGLIB$$e3cd7543:$jacocoInit()\n        `---[1761.00347ms] org.springframework.cglib.proxy.MethodInterceptor:intercept()\n            `---[1757.647111ms] com.xxx.service.impl.AdServiceImpl:refresh()\n                +---[0.006629ms] com.xxx.biz.yyy.service.impl.AServiceImpl:$jacocoInit()\n                +---[0.004073ms] java.util.Collections:singletonList()\n                +---[1709.203302ms] com.yyy.service.impl.AServiceImpl:refreshSomeThings()\n                `---[48.135719ms] com.yzzzz.service.impl.AServiceImpl:createSurvey()\n")])])]),r("p",[e._v("继续 trace 耗时最多的子函数，最后就可以定位到问题函数上。")]),e._v(" "),r("p",[e._v("当然对于大公司来说，项目比较复杂，RPC 调用比较多，这时候一般需要用到链路跟踪系统，快速定位耗时服务，然后再进入服务用 arthas 一步一步排查。")]),e._v(" "),r("h1",{attrs:{id:"常见优化方案"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#常见优化方案"}},[e._v("#")]),e._v(" 常见优化方案")]),e._v(" "),r("p",[r("img",{attrs:{src:"http://hunt-cdn.eyescode.top/content/9d3eb398-c2c3-947f-729a-4b75f51b936a.png",alt:"优化方案"}})]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("摘自：")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://blog.csdn.net/zj15527620802/article/details/115182528",target:"_blank",rel:"noopener noreferrer"}},[e._v("如何快速定位接口响应慢问题"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://juejin.cn/post/7167153109158854687",target:"_blank",rel:"noopener noreferrer"}},[e._v("用了这18种方案，接口性能提高了100倍！"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("站长略有修改")])])}),[],!1,null,null,null);r.default=s.exports}}]);